createuser "{{ result.db_user }}" --no-createrole --no-createdb --no-inherit --no-superuser -U postgres 2> /dev/null
createdb "{{ result.db_name }}" --owner="{{ result.db_user }}" -U postgres 2> /dev/null

if [ "$?" = "0" ] ; then
    psql -d "{{ result.db_name }}" -U "{{ result.db_user }}" < ../vendor/jrealm/dungeons/doc/dungeons.sql > /dev/null

    if [ -f ../doc/schema.sql ] ; then
        psql -d "{{ result.db_name }}" -U "{{ result.db_user }}" < ../doc/schema.sql > /dev/null
    fi

    if [ -f ../doc/data.sql ] ; then
        psql -d "{{ result.db_name }}" -U "{{ result.db_user }}" < ../doc/data.sql > /dev/null
    fi
fi
